<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiles Survive! - Optimization Helper</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
        h1, h2, h3, .font-logo {
            font-family: 'Luckiest Guy', cursive;
        }
        .nav-link.active {
            background-color: #34d399; /* emerald-400 */
            color: #111827; /* gray-900 */
        }
        /* New Accordion Styles using CSS Grid for robust animation */
        .accordion-content {
            display: grid;
            grid-template-rows: 0fr;
            transition: grid-template-rows 0.3s ease-out;
        }
        .accordion-button.open + .accordion-content {
            grid-template-rows: 1fr;
        }
        .accordion-content > div {
            overflow: hidden;
        }
        .accordion-button svg {
            transition: transform 0.3s ease-in-out;
        }
        .accordion-button.open svg {
            transform: rotate(180deg);
        }
        /* Ensure main content takes up available space */
        .main-container {
            display: flex;
            min-height: 100vh;
        }
        .content-wrapper {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 to-blue-900 text-gray-200">

<div class="main-container">
    <!-- Sidebar Navigation -->
    <nav class="fixed top-0 left-0 h-full w-64 bg-slate-800/70 backdrop-blur-sm p-5 flex flex-col z-30">
        <div class="text-center mb-10">
            <h1 class="font-logo text-3xl text-emerald-400">Tiles Survive!</h1>
            <p class="text-sm text-gray-400">Helper Tool</p>
        </div>
        <ul class="flex flex-col space-y-2" id="nav-menu">
            <li><a href="#guide" data-target="guide" class="nav-link flex items-center py-3 px-4 rounded-lg transition-colors duration-200 hover:bg-emerald-500/20 active"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v1.268l4.992 2.496a1 1 0 01.707 1.707l-4.992 2.496V11l4.25 2.125a1 1 0 01.707 1.707l-4.957 2.478A1 1 0 0112 18.5v-2.268l-4.992-2.496a1 1 0 01-.707-1.707l4.992-2.496V7L7.75 4.875a1 1 0 01-.707-1.707l4.957-2.478a1 1 0 01.3-.044z" clip-rule="evenodd" /></svg>Guide & Strategy</a></li>
            <li><a href="#power-plant" data-target="power-plant" class="nav-link flex items-center py-3 px-4 rounded-lg transition-colors duration-200 hover:bg-emerald-500/20"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" viewBox="0 0 20 20" fill="currentColor"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" /></svg>Power Plant Req's</a></li>
            <li><a href="#alliance-duel" data-target="alliance-duel" class="nav-link flex items-center py-3 px-4 rounded-lg transition-colors duration-200 hover:bg-emerald-500/20"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" viewBox="0 0 20 20" fill="currentColor"><path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015.5-4.96A5 5 0 0111 16v1H1v-1a5 5 0 015-5z" /></svg>Alliance Duel</a></li>
            <li><a href="#turbo-turtle" data-target="turbo-turtle" class="nav-link flex items-center py-3 px-4 rounded-lg transition-colors duration-200 hover:bg-emerald-500/20"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" /></svg>Turbo Turtle</a></li>
            <li><a href="#power-play" data-target="power-play" class="nav-link flex items-center py-3 px-4 rounded-lg transition-colors duration-200 hover:bg-emerald-500/20"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 5.555a1 1 0 011.888 0l1.264 3.862a1 1 0 00.948.65h4.03a1 1 0 01.588 1.81l-3.26 2.37a1 1 0 00-.364 1.118l1.264 3.862a1 1 0 01-1.528 1.18l-3.26-2.37a1 1 0 00-1.176 0l-3.26 2.37a1 1 0 01-1.528-1.18l1.264-3.862a1 1 0 00-.364-1.118L2.04 11.877a1 1 0 01.588-1.81h4.03a1 1 0 00.948-.65L9.555 5.555z" clip-rule="evenodd" /></svg>Power Play</a></li>
        </ul>
    </nav>

    <!-- Main Content Area -->
    <div class="content-wrapper ml-64">
        <main class="flex-grow p-8">
            <div id="content-container">
                <!-- Guide & Strategy Section -->
                <section id="guide" class="content-section space-y-6">
                    <h2 class="text-4xl text-emerald-400">Optimization Guide</h2>
                    <p>This tool is designed to help you optimize resource management in Tiles Survive! by providing clear, up-to-date information on tasks and event schedules. Plan ahead to maximize your rewards.</p>
                    <div class="bg-red-900/50 border border-red-500 rounded-lg p-4">
                        <h3 class="text-xl text-red-400">CRITICAL WARNING!</h3>
                        <p class="mt-2 text-red-200">Do not spend resources (speedups, materials, etc.) outside of corresponding events. Hoarding is key. Using items only when an event rewards you for it is the single most important strategy for efficient growth.</p>
                    </div>
                    <div id="guide-accordions" class="space-y-4"></div>
                </section>

                <!-- Power Plant Req's Section -->
                <section id="power-plant" class="content-section hidden space-y-6">
                    <h2 class="text-4xl text-emerald-400">Power Plant Requirements</h2>
                    <div class="bg-slate-800/70 backdrop-blur-sm rounded-lg overflow-hidden">
                        <table class="w-full text-left">
                            <thead class="bg-slate-700/80">
                                <tr>
                                    <th class="p-4 text-emerald-400">PP Level</th>
                                    <th class="p-4 text-emerald-400">Prerequisites</th>
                                </tr>
                            </thead>
                            <tbody id="power-plant-table-body" class="divide-y divide-slate-700"></tbody>
                        </table>
                    </div>
                </section>

                <!-- Alliance Duel Section -->
                <section id="alliance-duel" class="content-section hidden space-y-6">
                    <h2 class="text-4xl text-emerald-400">Alliance Duel</h2>
                    <div class="bg-slate-800/70 backdrop-blur-sm rounded-lg p-4 space-y-4">
                        <div>
                            <h3 class="text-2xl text-emerald-400 mb-2">Weekly Schedule</h3>
                            <div class="overflow-x-auto">
                                <table class="w-full text-left">
                                    <thead class="bg-slate-700/80">
                                        <tr>
                                            <th class="p-3">Day</th>
                                            <th class="p-3">Theme</th>
                                        </tr>
                                    </thead>
                                    <tbody id="alliance-duel-schedule-body" class="divide-y divide-slate-700"></tbody>
                                </table>
                            </div>
                        </div>
                        <div class="bg-blue-900/30 border border-blue-500 rounded-lg p-3">
                            <p class="text-sm">
                                <strong class="font-semibold text-blue-300">Point information:</strong> Points below assume all Alliance Duel tech research is at 100%, except for "Focus - Training" (Lv. 7/10) and "Focus - Kills" (Lv. 7/10).
                            </p>
                        </div>
                    </div>
                    <div id="alliance-duel-accordions" class="space-y-4"></div>
                </section>

                <!-- Turbo Turtle Section -->
                <section id="turbo-turtle" class="content-section hidden space-y-6">
                    <h2 class="text-4xl text-emerald-400">Turbo Turtle</h2>
                    <div id="turbo-turtle-accordions" class="space-y-4"></div>
                </section>

                <!-- Power Play Section -->
                <section id="power-play" class="content-section hidden space-y-6">
                    <h2 class="text-4xl text-emerald-400">Power Play</h2>
                    <p class="text-gray-400">Schedule is shown in UTC+1. Tasks rotate every 4 hours.</p>
                    <div id="power-play-accordions" class="space-y-4"></div>
                </section>
            </div>
        </main>

        <!-- Footer -->
        <footer class="text-center text-gray-500 p-4">
             <button id="version-history-btn" class="hover:text-white underline text-xs">Version History</button>
            <p class="text-xs mt-2">Disclaimer: This tool is a fan-made project and is not affiliated with the official developers of Tiles Survive!. Information is subject to change based on game updates.</p>
        </footer>
    </div>
</div>

<!-- Version History Modal -->
<div id="version-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-50">
    <div class="bg-slate-800 rounded-lg shadow-xl w-full max-w-lg p-6 m-4 relative">
        <button id="close-modal-btn" class="absolute top-3 right-3 text-gray-400 hover:text-white text-3xl leading-none">&times;</button>
        <h3 class="font-logo text-2xl text-emerald-400 mb-4">Version History</h3>
        <ul id="version-list" class="list-disc list-inside text-sm text-gray-300 space-y-2">
            <!-- JS will populate this -->
        </ul>
    </div>
</div>


<script>
// --- DATA ---
const versionHistory = [
    "v2.8 (2024-07-28): Added Power Play tasks for 'Chief Gear' theme.",
    "v2.7 (2024-07-28): Added Day 1 tasks for Alliance Duel, Turbo Turtle, and Power Play. Reverted to stable single-language version.",
    "v2.2 (2024-07-28): Added Turbo Turtle and Power Play rules to the Guide & Strategy page.",
    "v2.1 (2024-07-28): Added Alliance Duel rules and conditions to the Guide & Strategy page.",
    "v2.0 (2024-07-28): Completed Turbo Turtle event data with detailed tasks and points for Phase 7.",
    "v1.9 (2024-07-28): Added an intellectual property disclaimer in the footer.",
    "v1.8 (2024-07-27): Renamed Home to Guide & Strategy and added detailed instructions.",
    "v1.7 (2024-07-27): Corrected Power Play schedule time to UTC+1."
];

const powerPlantData = [
    { level: 17, prerequisites: ["Comms Outpost Lv.16", "Barracks 1 Lv.16"] }, { level: 18, prerequisites: [] }, { level: 19, prerequisites: [] }, { level: 20, prerequisites: [] }, { level: 21, prerequisites: [] }, { level: 22, prerequisites: [] },
    { level: 23, prerequisites: ["Comms Outpost Lv.22", "Barracks 1 Lv.22"] }, { level: 24, prerequisites: ["Lab 1 Lv.23", "Hero Academy Lv.18"] }, { level: 25, prerequisites: ["Comms Outpost Lv.24", "Barracks 1 Lv.24"] },
    { level: 26, prerequisites: ["Lab 1 Lv.25", "Golden Aegis Lv.20"] }, { level: 27, prerequisites: ["Comms Outpost Lv.26", "Barracks 1 Lv.26"] }, { level: 28, prerequisites: ["Lab 1 Lv.27", "Guardian of Life Lv.23"] },
    { level: 29, prerequisites: ["Comms Outpost Lv.28", "Barracks 1 Lv.28", "Golden Aegis Lv.24"] }, { level: 30, prerequisites: ["Lab 1 Lv.29", "Barracks 1 Lv.29", "Warbringer Lv.26"] },
];

const allianceDuelSchedule = [
    { day: "Day 1", theme: "Radar Training" }, { day: "Day 2", theme: "Base Building" }, { day: "Day 3", theme: "Tech Research" },
    { day: "Day 4", theme: "Hero Development" }, { day: "Day 5", theme: "Battle Prep" }, { day: "Day 6", theme: "Defeat Enemies" },
];

const allianceDuelTasks = {
    "Day 1": [ { task: "Consume 1 Chief Stamina", points: "+600" }, { task: "Complete 1 Intel Mission(s)", points: "+93750" }, { task: "Use 100 points of Gear Scraps", points: "+5800" }, { task: "Use 400 points of Gear Scraps", points: "+23000" }, { task: "Use 2,000 points of Gear Scraps", points: "+114400" }, { task: "Use 10,000 points of Gear Scraps", points: "+571600" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+20" }, { task: "Gather 100 Food", points: "+2" }, { task: "Gather 100 Wood", points: "+2" }, { task: "Gather 20 Metal", points: "+2" }, { task: "Gather 5 Gas", points: "+2" }, ],
    "Day 2": [
        { task: "Use 1 min(s) of Speedups on Construction", points: "+625" },
        { task: "Increase Power by 1 through Construction", points: "+22" },
        { task: "Dispatch 1 A-class truck(s)", points: "+100000" },
        { task: "Perform 1 S-tier task(s) in Dire Dispatch", points: "+150000" },
        { task: "Earn 1 Diamonds through bundle purchases", points: "+20" }
    ],
    "Day 3": [{ task: "Use 1 min(s) of Speedups on Research", points: "+625" }, { task: "Increase Power by 1 through Research", points: "+10" }, { task: "Spend 1 Clash Medal(s)", points: "+5000" }, { task: "Complete 1 Intel Mission(s)", points: "+75,000" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+20" }, { task: "Every 100 Behemoth EXP gained in a single attempt", points: "+2,000" }, { task: "Use 1 Behemoth Cell(s)", points: "+24,000" },],
    "Day 4": [{ task: "Perform 1 Targeted Draft(s)", points: "+33,500" }, { task: "Perform 1 Advanced Recruitment(s)", points: "+7,500" }, { task: "Perform 1 Standard Recruitment(s)", points: "+1,250" }, { task: "Use a Legendary Hero Fragment", points: "+30,400" }, { task: "Use an Epic Hero Fragment", points: "+3,200" }, { task: "Use a Rare Hero Fragment", points: "+320" }, { task: "Use 1 Hero Skill Manual(s)", points: "+5,000" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+20" },],
    "Day 5": [{ task: "Complete 1 Intel Mission(s)", points: "+93,750" }, { task: "Use 1 min(s) of Speedups on Construction", points: "+625" }, { task: "Increase Power by 1 through Construction", points: "+22" }, { task: "Use 1 min(s) of Speedups on Research", points: "+625" }, { task: "Increase Power by 1 through Research", points: "+10" }, { task: "Use 1 min(s) of Speedups on Troop Training/Upgrading", points: "+625" }, { task: "Train a Lv. 1 Soldier", points: "+14" }, { task: "Train a Lv. 2 Soldier", points: "+25" }, { task: "Train a Lv. 3 Soldier", points: "+39" }, { task: "Train a Lv. 4 Soldier", points: "+51" }, { task: "Train a Lv. 5 Soldier", points: "+61" }, { task: "Train a Lv. 6 Soldier", points: "N/A" }, { task: "Train a Lv. 7 Soldier", points: "N/A" }, { task: "Train a Lv. 8 Soldier", points: "N/A" }, { task: "Train a Lv. 9 Soldier", points: "N/A" }, { task: "Train a Lv. 10 Soldier", points: "N/A" },],
    "Day 6": [{ task: "Collect 1 Flawed Sandworm Egg in Burrow Conquest", points: "+5,000" }, { task: "Collect 1 Fresh Sandworm Egg in Burrow Conquest", points: "+50,000" }, { task: "Collect 1 Perfect Sandworm Egg in Burrow Conquest", points: "+500,000" }, { task: "Dispatch 1 A-class truck(s)", points: "+100,000" }, { task: "Perform 1 S-tier task(s) in Dire Dispatch", points: "+150,000" }, { task: "Use 1 min(s) of Speedups on Construction", points: "+625" }, { task: "Use 1 min(s) of Speedups on Research", points: "+625" }, { task: "Use 1 min(s) of Speedups on Troop Training/Upgrading", points: "+625" }, { task: "Use 1 minute(s) of Healing Speedups", points: "+625" }, { task: "Defeat 1 Lv. 1 troop in burrows, cities, or Arcadia", points: "+4" }, { task: "Defeat 1 Lv. 2 troop in burrows, cities, or Arcadia", points: "+9" }, { task: "Defeat 1 Lv. 3 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 4 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 5 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 6 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 7 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 8 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 9 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 10 troop in burrows, cities, or Arcadia", points: "N/A" },],
};

const turboTurtleSchedule = [
    { phase: "Phase 1", theme: "Gear Refinement" }, { phase: "Phase 2", theme: "Construction & Gear" }, { phase: "Phase 3", theme: "Behemoth & Research" },
    { phase: "Phase 4", theme: "Hero Upgrades" }, { phase: "Phase 5", theme: "Gear Enhancement" }, { phase: "Phase 6", theme: "Training & Research" }, { phase: "Phase 7", theme: "Power Rush" },
];

const turboTurtleTasks = {
    "Phase 1": [ { task: "Use 1 min(s) of Speedups on Research", points: "+700" }, { task: "Use 100 points of Gear Scraps", points: "+4,000" }, { task: "Use 400 points of Gear Scraps", points: "+16,000" }, { task: "Use 2,000 points of Gear Scraps", points: "+80,000" }, { task: "Use 10,000 points of Gear Scraps", points: "+400,000" }, { task: "Train a Lv. 1 Soldier", points: "+32" }, { task: "Train a Lv. 2 Soldier", points: "+55" }, { task: "Train a Lv. 3 Soldier", points: "+90" }, { task: "Train a Lv. 4 Soldier", points: "+115" }, { task: "Train a Lv. 5 Soldier", points: "+144" }, { task: "Train a Lv. 6 Soldier", points: "+190" }, { task: "Train a Lv. 7 Soldier", points: "+240" }, { task: "Train a Lv. 8 Soldier", points: "+340" }, { task: "Train a Lv. 9 Soldier", points: "+540" }, { task: "Train a Lv. 10 Soldier", points: "+1,200" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+400" }, ],
    "Phase 2": [
        { task: "Use 1 min(s) of Speedups on Construction", points: "+700" },
        { task: "Use 100 points of Gear Scraps", points: "+4,000" },
        { task: "Use 400 points of Gear Scraps", points: "+16,000" },
        { task: "Use 2,000 points of Gear Scraps", points: "+80,000" },
        { task: "Use 10,000 points of Gear Scraps", points: "+400,000" },
        { task: "Earn 1 Diamonds through bundle purchases", points: "+400" }
    ],
    "Phase 3": [{ task: "Use 1 Behemoth Cell(s)", points: "+20,000" }, { task: "Every 100 Behemoth EXP gained in a single attempt", points: "+1,000" }, { task: "Use 1 min(s) of Speedups on Research", points: "+700" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+400" },],
    "Phase 4": [{ task: "Spend Draft Vouchers on Hero Recruitment 1 time(s)", points: "+20,000" }, { task: "Spend Advanced Recruitment Tokens on Hero Recruitment 1 time(s)", points: "+8,000" }, { task: "Spend Standard Recruitment Tokens on Hero Recruitment 1 time(s)", points: "+2,000" }, { task: "Use a Legendary Hero Fragment", points: "+35,000" }, { task: "Use an Epic Hero Fragment", points: "+9,000" }, { task: "Use a Rare Hero Fragment", points: "+3,000" }, { task: "Use 1 Hero Skill Manual(s)", points: "+2,500" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+400" },],
    "Phase 5": [{ task: "Use 1 Adhesive", points: "+3,000" }, { task: "Use 1 Chief Gear Design(s)", points: "+150,000" }, { task: "Use 100 points of Gear Scraps", points: "+4,000" }, { task: "Use 400 points of Gear Scraps", points: "+16,000" }, { task: "Use 2,000 points of Gear Scraps", points: "+80,000" }, { task: "Use 10,000 points of Gear Scraps", points: "+400,000" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+400" },],
    "Phase 6": [{ task: "Use 1 min(s) of Speedups on Research", points: "+700" }, { task: "Train or Upgrade Troops", points: "N/A" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+400" },],
    "Phase 7": [ { task: "Use 1 min(s) of Speedups on Construction", points: "+700" }, { task: "Use 1 min(s) of Speedups on Research", points: "+700" }, { task: "Spend Draft Vouchers on Hero Recruitment 1 time(s)", points: "+20,000" }, { task: "Spend Advanced Recruitment Tokens on Hero Recruitment 1 time(s)", points: "+8,000" }, { task: "Spend Standard Recruitment Tokens on Hero Recruitment 1 time(s)", points: "+2,000" }, { task: "Use a Legendary Hero Fragment", points: "+35,000" }, { task: "Use an Epic Hero Fragment", points: "+9,000" }, { task: "Use a Rare Hero Fragment", points: "+3,000" }, { task: "Use 1 Hero Skill Manual(s)", points: "+2,500" }, { task: "Use 100 points of Gear Scraps", points: "+4,000" }, { task: "Use 400 points of Gear Scraps", points: "+16,000" }, { task: "Use 2,000 points of Gear Scraps", points: "+80,000" }, { task: "Use 10,000 points of Gear Scraps", points: "+400,000" }, { task: "Use 1 Behemoth Cell(s)", points: "+20,000" }, { task: "Every 100 Behemoth EXP gained in a single attempt", points: "+1,000" }, { task: "Use 1 Adhesive", points: "+3,000" }, { task: "Use 1 Chief Gear Design(s)", points: "+150,000" }, { task: "Kill Lv. 1-6 Infected", points: "+10,000" }, { task: "Kill Lv. 7-12 Infected", points: "+10,500" }, { task: "Kill Lv. 13-18 Infected", points: "+11,000" }, { task: "Kill Lv. 19-24 Infected", points: "+11,500" }, { task: "Kill Lv. 25-30 Infected", points: "+12,000" }, { task: "Rally Lv. 1-30 Infected Fiend", points: "+30,000" }, { task: "Kill an Infected via Intel", points: "+60,000" }, { task: "Gather 100 Food", points: "+2" }, { task: "Gather 100 Wood", points: "+2" }, { task: "Gather 20 Metal", points: "+2" }, { task: "Gather 5 Gas", points: "+2" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+400" }, ],
};

const powerPlayTasksByTheme = {
    "Hero Upgrade": [ { task: "Use a Legendary Hero Fragment", points: "x9000" }, { task: "Use an Epic Hero Fragment", points: "x1000" }, { task: "Use a Rare Hero Fragment", points: "x150" }, { task: "Use 1 Hero Skill Manual(s)", points: "x857" }, { task: "Earn 1 Diamonds through bundle purchases", points: "x60" }, ],
    "Chief Gear": [ { task: "Use 1 Adhesive", points: "x630" }, { task: "Use 1 Chief Gear Design(s)", points: "x29000" }, { task: "Earn 1 Diamonds through bundle purchases", points: "x60" }, ],
    "Gear Enhancement": [
        { task: "Use 100 points of Gear Scraps", points: "x714" },
        { task: "Use 400 points of Gear Scraps", points: "x2857" },
        { task: "Use 2,000 points of Gear Scraps", points: "x14286" },
        { task: "Use 10,000 points of Gear Scraps", points: "x71429" },
        { task: "Earn 1 Diamonds through bundle purchases", points: "x60" },
    ],
    "Tech Research": [
        { task: "Increase Power by 1 through Research", points: "x3" },
        { task: "Use 1 min(s) of Speedups on Research", points: "x42" },
        { task: "Earn 1 Diamonds through bundle purchases", points: "x60" },
    ],
    "Settlement Construction": [
        { task: "Increase Power by 1 through Construction", points: "x3" },
        { task: "Use 1 min(s) of Speedups on Construction", points: "x42" },
        { task: "Earn 1 Diamonds through bundle purchases", points: "x60" },
    ]
};

const powerPlaySchedule = {
    "Day 1": [ { time: "01:00:00", theme: "Hero Upgrade" }, { time: "05:00:00", theme: "Settlement Construction" }, { time: "09:00:00", theme: "Chief Gear" }, { time: "13:00:00", theme: "Tech Research" }, { time: "17:00:00", theme: "Gear Enhancement" }, { time: "21:00:00", theme: "Behemoth Growth" }, ],
    "Day 2": [ { time: "01:00:00", theme: "Settlement Construction" }, { time: "05:00:00", theme: "Chief Gear" }, { time: "09:00:00", theme: "Tech Research" }, { time: "13:00:00", theme: "Gear Enhancement" }, { time: "17:00:00", theme: "Behemoth Growth" }, { time: "21:00:00", theme: "Hero Upgrade" }, ],
    "Day 3": [ { time: "01:00:00", theme: "Chief Gear" }, { time: "05:00:00", theme: "Tech Research" }, { time: "09:00:00", theme: "Gear Enhancement" }, { time: "13:00:00", theme: "Behemoth Growth" }, { time: "17:00:00", theme: "Hero Upgrade" }, { time: "21:00:00", theme: "Settlement Construction" }, ],
    "Day 4": [ { time: "01:00:00", theme: "Tech Research" }, { time: "05:00:00", theme: "Gear Enhancement" }, { time: "09:00:00", theme: "Behemoth Growth" }, { time: "13:00:00", theme: "Hero Upgrade" }, { time: "17:00:00", theme: "Settlement Construction" }, { time: "21:00:00", theme: "Chief Gear" }, ],
    "Day 5": [ { time: "01:00:00", theme: "Gear Enhancement" }, { time: "05:00:00", theme: "Behemoth Growth" }, { time: "09:00:00", theme: "Hero Upgrade" }, { time: "13:00:00", theme: "Settlement Construction" }, { time: "17:00:00", theme: "Chief Gear" }, { time: "21:00:00", theme: "Tech Research" }, ],
    "Day 6": [ { time: "01:00:00", theme: "Behemoth Growth" }, { time: "05:00:00", theme: "Hero Upgrade" }, { time: "09:00:00", theme: "Settlement Construction" }, { time: "13:00:00", theme: "Chief Gear" }, { time: "17:00:00", theme: "Tech Research" }, { time: "21:00:00", theme: "Gear Enhancement" }, ],
    "Day 7": [ { time: "01:00:00", theme: "Hero Upgrade" }, { time: "05:00:00", theme: "Settlement Construction" }, { time: "09:00:00", theme: "Chief Gear" }, { time: "13:00:00", theme: "Tech Research" }, { time: "17:00:00", theme: "Gear Enhancement" }, { time: "21:00:00", theme: "Behemoth Growth" }, ],
};


document.addEventListener('DOMContentLoaded', () => {
    // --- HELPERS ---
    const createAccordion = (title, content) => {
        const wrapper = document.createElement('div');
        wrapper.className = 'bg-slate-800/70 backdrop-blur-sm rounded-lg overflow-hidden';
        wrapper.innerHTML = `
            <button class="accordion-button w-full flex justify-between items-center p-4 text-left text-emerald-400 font-semibold text-lg hover:bg-slate-700/50 transition-colors">
                <span>${title}</span>
                <svg class="h-6 w-6 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
            </button>
            <div class="accordion-content">
                <div class="p-4 border-t border-slate-700">
                    ${content}
                </div>
            </div>
        `;
        return wrapper;
    };

    const createTable = (headers, rows) => {
        let tableHTML = `<div class="overflow-x-auto"><table class="w-full text-left text-sm"><thead><tr class="bg-slate-900/50">`;
        headers.forEach(h => tableHTML += `<th class="p-2">${h}</th>`);
        tableHTML += `</tr></thead><tbody class="divide-y divide-slate-600">`;
        if (rows.length === 0) {
            tableHTML += `<tr><td colspan="${headers.length}" class="p-4 text-center text-gray-400">No tasks listed for this day.</td></tr>`;
        } else {
            rows.forEach(row => {
                tableHTML += `<tr class="hover:bg-slate-700/40">`;
                row.forEach(cell => tableHTML += `<td class="p-2">${cell}</td>`);
                tableHTML += `</tr>`;
            });
        }
        tableHTML += `</tbody></table></div>`;
        return tableHTML;
    };

    // --- PAGE POPULATION FUNCTIONS ---
    
    function populateGuidePage() {
        const guideEvents = [
             { 
                title: "Power Plant Req's", 
                simpleContent: `
                    <p class="text-gray-300">
                        This section helps you plan your upgrades efficiently. Use the <strong class="text-emerald-400">"Power Plant Req's"</strong> menu on your left to find out the building prerequisites for your next Power Plant levels.
                    </p>
                    <p class="mt-3 text-gray-400 text-sm">
                        <strong>Note:</strong> Resource costs and construction times are not listed here. The sole purpose is to answer the question: "What required buildings should I upgrade while my current Power Plant upgrade is in progress?"
                    </p>
                `
            },
            { 
                title: "Alliance Duel",
                howToUse: `<p class="text-gray-300">Use the <strong class="text-emerald-400">"Alliance Duel"</strong> menu to check the daily theme. Plan ahead and save your resources to score maximum points on the corresponding day. This is the key to unlocking all 9 personal milestone chests daily and helping your alliance win the duel.</p>`,
                rules: `<ul class="list-disc list-inside text-gray-300 space-y-2"><li>A Power Plant level 10 is required to participate.</li><li>Your Alliance must have 10 or more members.</li><li><strong class="text-amber-400">Important:</strong> Switching Alliances during the event will block your point contributions for that day. Your personal milestone rewards will not be affected.</li></ul>`,
                tip: `<p class="text-gray-300">Patience is key. Hoard your speedups, fragments, and materials until the day they are featured in the duel. While this might slightly delay your personal progress, the massive boost in points will earn you far greater rewards and be a huge help to your alliance's victory.</p>`
            },
            { 
                title: "Turbo Turtle", 
                howToUse: `<p class="text-gray-300">Use the <strong class="text-emerald-400">"Turbo Turtle"</strong> menu to check the daily phase. The main goal is to unlock all 5 milestone chests each day to collect the 3 daily Race Medals. Accumulating 20 medals allows you to buy the weekly "Custom Alloy Gear Crate" from the event store.</p>`,
                rules: `<ul class="list-disc list-inside text-gray-300 space-y-2"><li>The event consists of 5-8 stages, each lasting 1-2 days.</li><li>Players are grouped into tiers (Bronze to Master). Top performers in each group advance to a higher tier for better rewards, while bottom performers drop.</li><li>Your final tier carries over to the next event session.</li></ul>`, 
                tip: "Check the phases in advance. The final phase, 'Power Rush', often allows points from many categories, making it a good time to use any remaining resources." 
            },
            { 
                title: "Power Play", 
                rules: `<ul class="list-disc list-inside text-gray-300 space-y-2"><li>The event opens daily, with a new theme every 4 hours.</li><li>Every day, 12 players with similar Power Plant levels are grouped for ranking.</li><li>A minimum of 1 point is required to be eligible for daily ranking rewards.</li></ul>`, 
                tip: "Set alarms for the themes you want to focus on, like Hero Upgrades or Chief Gear. The point multipliers are significant." 
            }
        ];
        const guideContainer = document.getElementById('guide-accordions');
        guideContainer.innerHTML = ''; // Clear previous content
        guideEvents.forEach(event => {
            let content;
            if (event.simpleContent) {
                content = event.simpleContent;
            } else {
                content = `
                    <div class="space-y-3">
                        ${createAccordion('How to use this section', event.howToUse || `<p>Use this to understand the event's purpose and how to best prepare for it.</p>`).innerHTML}
                        ${createAccordion('Event Rules & Conditions', event.rules || `<p>Specific rules for this event.</p>`).innerHTML}
                        ${createAccordion('Tips & Tricks', event.tip || `<p>Tips and tricks to maximize your points.</p>`).innerHTML}
                    </div>
                `;
            }
            guideContainer.appendChild(createAccordion(event.title, content));
        });
    }

    function populatePowerPlantPage() {
        const ppBody = document.getElementById('power-plant-table-body');
        ppBody.innerHTML = ''; // Clear previous content
        powerPlantData.forEach(item => {
            const row = document.createElement('tr');
            row.className = 'hover:bg-slate-700/40';
            row.innerHTML = `
                <td class="p-4 font-semibold">${item.level}</td>
                <td class="p-4">${item.prerequisites.length > 0 ? item.prerequisites.join(', ') : '<span class="text-gray-500">N/A</span>'}</td>
            `;
            ppBody.appendChild(row);
        });
    }

    function populateAllianceDuelPage() {
        const adScheduleBody = document.getElementById('alliance-duel-schedule-body');
        adScheduleBody.innerHTML = ''; // Clear previous content
        allianceDuelSchedule.forEach(item => {
            const row = document.createElement('tr');
            row.className = 'hover:bg-slate-700/40';
            row.innerHTML = `<td class="p-3">${item.day}</td><td class="p-3">${item.theme}</td>`;
            adScheduleBody.appendChild(row);
        });

        const adAccordions = document.getElementById('alliance-duel-accordions');
        adAccordions.innerHTML = ''; // Clear previous content
        allianceDuelSchedule.forEach(item => {
            const tasks = allianceDuelTasks[item.day] || [];
            const taskRows = tasks.map(t => [t.task, t.points]);
            const table = createTable(['Task', 'Points'], taskRows);
            adAccordions.appendChild(createAccordion(`${item.day}: ${item.theme}`, table));
        });
    }

    function populateTurboTurtlePage() {
        const ttAccordions = document.getElementById('turbo-turtle-accordions');
        ttAccordions.innerHTML = ''; // Clear previous content
        turboTurtleSchedule.forEach(item => {
            const tasks = turboTurtleTasks[item.phase] || [];
            const taskRows = tasks.map(t => [t.task, t.points]);
            const table = createTable(['Task', 'Points'], taskRows);
            ttAccordions.appendChild(createAccordion(`${item.phase}: ${item.theme}`, table));
        });
    }

    function populatePowerPlayPage() {
        const ppAccordions = document.getElementById('power-play-accordions');
        ppAccordions.innerHTML = ''; // Clear previous content
        Object.keys(powerPlaySchedule).forEach(day => {
            const daySchedule = powerPlaySchedule[day];
            const scheduleRows = daySchedule.map(slot => {
                const hasDetails = powerPlayTasksByTheme[slot.theme];
                let themeCell = slot.theme;
                if (hasDetails) {
                    const subTableRows = hasDetails.map(t => [t.task, t.points]);
                    const subTable = createTable(['Task', 'Multiplier'], subTableRows);
                    themeCell += `<div class="mt-2 text-xs">${subTable}</div>`;
                }
                return [slot.time, themeCell];
            });
            const dayContent = createTable(['Time (UTC+1)', 'Theme & Tasks'], scheduleRows);
            ppAccordions.appendChild(createAccordion(day, dayContent));
        });
    }

    function populateVersionHistory() {
        const versionList = document.getElementById('version-list');
        versionList.innerHTML = ''; // Clear previous content
        versionHistory.forEach(entry => {
            const li = document.createElement('li');
            li.textContent = entry;
            versionList.appendChild(li);
        });
    }

    // --- EVENT LISTENERS ---

    // Navigation
    const navMenu = document.getElementById('nav-menu');
    const navLinks = navMenu.querySelectorAll('.nav-link');
    const contentSections = document.querySelectorAll('.content-section');

    navMenu.addEventListener('click', (e) => {
        const link = e.target.closest('.nav-link');
        if (!link) return;
        e.preventDefault();

        const targetId = link.dataset.target;

        navLinks.forEach(l => l.classList.remove('active'));
        link.classList.add('active');

        contentSections.forEach(section => {
            section.classList.toggle('hidden', section.id !== targetId);
        });
    });

    // Accordions
    document.body.addEventListener('click', (e) => {
        const button = e.target.closest('.accordion-button');
        if (!button) return;
        
        button.classList.toggle('open');
    });

    // Modal Logic
    const modal = document.getElementById('version-modal');
    const openBtn = document.getElementById('version-history-btn');
    const closeBtn = document.getElementById('close-modal-btn');

    openBtn.addEventListener('click', () => {
        modal.classList.remove('hidden');
    });

    closeBtn.addEventListener('click', () => {
        modal.classList.add('hidden');
    });

    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            modal.classList.add('hidden');
        }
    });
    
    // --- INITIALIZATION ---
    function initializeApp() {
        populateGuidePage();
        populatePowerPlantPage();
        populateAllianceDuelPage();
        populateTurboTurtlePage();
        populatePowerPlayPage();
        populateVersionHistory();
    }
    
    initializeApp();
});
</script>
</body>
</html>
