<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiles Survive! - Game Helper</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        .font-logo {
            font-family: 'Luckiest Guy', cursive;
        }
        .content-wrapper {
            display: flex;
            flex: 1;
        }
        .nav-link.active {
            background-color: #10B981; /* emerald-500 */
            color: #FFFFFF; /* white */
            font-weight: 600;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        /* Accordion styles */
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        /* Modal styles */
        #version-modal {
            display: none; /* Hidden by default */
        }
        #version-modal.flex {
            display: flex; /* Shown when class is added */
        }
    </style>
</head>
<body class="bg-gradient-to-b from-slate-900 to-blue-900 text-gray-200">

    <div class="content-wrapper">
        <!-- Sidebar Navigation -->
        <aside class="bg-slate-800/80 backdrop-blur-sm text-white w-64 space-y-6 py-7 px-2">
            <a href="#guide" class="text-white flex items-center space-x-2 px-4">
                <span class="font-logo text-4xl tracking-wider text-shadow">TILES SURVIVE!</span>
            </a>

            <nav id="nav-menu">
                <a href="#guide" class="nav-link block py-2.5 px-4 rounded-lg transition duration-200 hover:bg-slate-700/50">
                    Guide & Strategy
                </a>
                <a href="#power-plant" class="nav-link block py-2.5 px-4 rounded-lg transition duration-200 hover:bg-slate-700/50">
                    Power Plant Req's
                </a>
                <a href="#alliance-duel" class="nav-link block py-2.5 px-4 rounded-lg transition duration-200 hover:bg-slate-700/50">
                    Alliance Duel
                </a>
                <a href="#turbo-turtle" class="nav-link block py-2.5 px-4 rounded-lg transition duration-200 hover:bg-slate-700/50">
                    Turbo Turtle
                </a>
                <a href="#power-play" class="nav-link block py-2.5 px-4 rounded-lg transition duration-200 hover:bg-slate-700/50">
                    Power Play
                </a>
            </nav>
        </aside>

        <!-- Main content -->
        <main class="flex-1 p-6 md:p-10">
            
            <!-- Guide & Strategy Section -->
            <section id="guide" class="content-section">
                <h1 class="font-logo text-5xl md:text-6xl text-white mb-6 drop-shadow-lg">Optimization Guide</h1>
                <div class="space-y-6 text-lg bg-slate-800/50 p-6 rounded-lg shadow-md">
                    <p>
                        Welcome to the Tiles Survive! Helper. The main goal of this tool is to help you **optimize your resource spending**. To get the most rewards and grow faster, you should only use your items (speedups, fragments, materials, etc.) during events where they give you points.
                    </p>

                    <div class="bg-red-900/80 border border-red-700 text-red-100 px-4 py-3 rounded-lg relative shadow-lg" role="alert">
                        <strong class="font-bold flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                            CRITICAL WARNING!
                        </strong>
                        <span class="block sm:inline mt-2">Using your resources outside of a relevant event is a waste. Always check the event schedules in this tool before spending anything!</span>
                    </div>

                    <div>
                        <h2 class="font-logo text-3xl text-emerald-400 mb-3">How to Use Each Section</h2>
                        <ul class="list-disc list-inside space-y-4">
                            <li>
                                <strong class="font-semibold">Power Plant Req's:</strong> Use this section to plan your building upgrades. Knowing the prerequisites for high-level Power Plants helps you avoid getting stuck and allows you to build efficiently.
                            </li>
                            <li>
                                <strong class="font-semibold">Alliance Duel:</strong> This is a key weekly event. Check the schedule at the start of the week and prepare your resources for each day's theme. For example, save all your research speedups for "Tech Research" day to score maximum points for yourself and your alliance.
                            </li>
                            <li>
                                <strong class="font-semibold">Turbo Turtle:</strong> Another major weekly event. The tasks for each phase are different. Consult this guide to know when to use your Hero Fragments, Behemoth items, or Chief Gear materials.
                            </li>
                            <li>
                                <strong class="font-semibold">Power Play:</strong> This event changes every few hours. Before using any speedups or items, quickly check the current theme here. A few seconds of verification can save you from wasting items that would have given you points just a few hours later.
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Power Plant Section -->
            <section id="power-plant" class="content-section">
                <h1 class="font-logo text-4xl md:text-5xl text-white mb-2 drop-shadow-lg">Power Plants</h1>
                 <p class="text-md mb-6 text-gray-400">Building requirements for upgrading the power plant.</p>
                <div class="bg-slate-800/70 backdrop-blur-sm p-4 md:p-6 rounded-xl shadow-lg">
                    <div class="overflow-x-auto mt-4">
                        <table class="min-w-full">
                            <thead class="border-b-2 border-emerald-500">
                                <tr>
                                    <th class="py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider">Upgrade to Level</th>
                                    <th class="py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider">Building Prerequisites</th>
                                </tr>
                            </thead>
                            <tbody id="power-plant-table" class="divide-y divide-slate-700">
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Alliance Duel Section -->
            <section id="alliance-duel" class="content-section">
                <h1 class="font-logo text-4xl md:text-5xl text-white mb-6 drop-shadow-lg">Alliance Duel</h1>
                <div class="bg-slate-800/70 backdrop-blur-sm p-4 md:p-6 rounded-xl shadow-lg mb-8">
                    <h2 class="text-2xl font-semibold mb-4 border-b pb-2 border-slate-600">Weekly Schedule</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead class="border-b-2 border-emerald-500">
                                <tr>
                                    <th class="py-3 px-4 text-left">Day</th>
                                    <th class="py-3 px-4 text-left">Theme</th>
                                </tr>
                            </thead>
                            <tbody id="duel-schedule-table" class="divide-y divide-slate-700">
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="bg-blue-900/80 border border-blue-700 text-blue-100 px-4 py-3 rounded-lg relative mb-6 shadow-lg" role="alert">
                    <strong class="font-bold">Point Information:</strong>
                    <span class="block sm:inline">Points below assume all Alliance Duel tech research is at 100%, except for "Focus - Training" (Lv. 7/10) and "Focus - Kills" (Lv. 7/10).</span>
                </div>
                <div id="duel-daily-tasks" class="space-y-4">
                </div>
            </section>

            <!-- Turbo Turtle Section -->
            <section id="turbo-turtle" class="content-section">
                <h1 class="font-logo text-4xl md:text-5xl text-white mb-6 drop-shadow-lg">Turbo Turtle</h1>
                <p class="text-md mb-6 text-gray-400">Weekly event tasks to earn points.</p>
                <div id="turtle-daily-tasks" class="space-y-4">
                </div>
            </section>

            <!-- Power Play Section -->
            <section id="power-play" class="content-section">
                <h1 class="font-logo text-4xl md:text-5xl text-white mb-6 drop-shadow-lg">Power Play</h1>
                <p class="text-md mb-6 text-gray-400">Daily event schedule and tasks.</p>
                <div id="power-play-daily-tasks" class="space-y-4">
                </div>
            </section>

        </main>
    </div>

    <!-- Footer for Version History -->
    <footer class="bg-slate-900/80 text-gray-400 text-center p-3">
        <button id="version-history-btn" class="hover:text-white underline text-xs">Version History</button>
    </footer>

    <!-- Version History Modal -->
    <div id="version-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 items-center justify-center">
        <div class="bg-slate-800 text-gray-200 rounded-lg shadow-xl p-6 w-full max-w-md mx-4 relative border-2 border-emerald-500">
            <button id="close-modal-btn" class="absolute top-2 right-3 text-gray-500 hover:text-white text-3xl leading-none">&times;</button>
            <h3 class="font-logo text-2xl font-semibold mb-4 text-emerald-400">Version History</h3>
            <ul id="version-list" class="list-disc list-inside text-sm text-gray-400 space-y-1">
            </ul>
        </div>
    </div>


    <script>
        // --- DATA ---
        const powerPlantData = [
            { level: 17, prerequisites: ["Comms Outpost Lv.16", "Barracks 1 Lv.16"] }, { level: 18, prerequisites: [] }, { level: 19, prerequisites: [] }, { level: 20, prerequisites: [] }, { level: 21, prerequisites: [] }, { level: 22, prerequisites: [] },
            { level: 23, prerequisites: ["Comms Outpost Lv.22", "Barracks 1 Lv.22"] }, { level: 24, prerequisites: ["Lab 1 Lv.23", "Hero Academy Lv.18"] }, { level: 25, prerequisites: ["Comms Outpost Lv.24", "Barracks 1 Lv.24"] },
            { level: 26, prerequisites: ["Lab 1 Lv.25", "Golden Aegis Lv.20"] }, { level: 27, prerequisites: ["Comms Outpost Lv.26", "Barracks 1 Lv.26"] }, { level: 28, prerequisites: ["Lab 1 Lv.27", "Guardian of Life Lv.23"] },
            { level: 29, prerequisites: ["Comms Outpost Lv.28", "Barracks 1 Lv.28", "Golden Aegis Lv.24"] }, { level: 30, prerequisites: ["Lab 1 Lv.29", "Barracks 1 Lv.29", "Warbringer Lv.26"] },
        ];

        const allianceDuelSchedule = [
            { day: "Day 1 (Monday)", theme: "Radar Training" }, { day: "Day 2 (Tuesday)", theme: "Base Building" }, { day: "Day 3 (Wednesday)", theme: "Tech Research" },
            { day: "Day 4 (Thursday)", theme: "Hero Development" }, { day: "Day 5 (Friday)", theme: "Battle Prep" }, { day: "Day 6 (Saturday)", theme: "Defeat Enemies" },
        ];

        const allianceDuelTasks = {
            "Day 1": [], "Day 2": [],
            "Day 3": [{ task: "Use 1 min(s) of Speedups on Research", points: "+625" }, { task: "Increase Power by 1 through Research", points: "+10" }, { task: "Spend 1 Clash Medal(s)", points: "+5000" }, { task: "Complete 1 Intel Mission(s)", points: "+75,000" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+20" }, { task: "Every 100 Behemoth EXP gained in a single attempt", points: "+2,000" }, { task: "Use 1 Behemoth Cell(s)", points: "+24,000" },],
            "Day 4": [{ task: "Perform 1 Targeted Draft(s)", points: "+33,500" }, { task: "Perform 1 Advanced Recruitment(s)", points: "+7,500" }, { task: "Perform 1 Standard Recruitment(s)", points: "+1,250" }, { task: "Use a Legendary Hero Fragment", points: "+30,400" }, { task: "Use an Epic Hero Fragment", points: "+3,200" }, { task: "Use a Rare Hero Fragment", points: "+320" }, { task: "Use 1 Hero Skill Manual(s)", points: "+5,000" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+20" },],
            "Day 5": [{ task: "Complete 1 Intel Mission(s)", points: "+93,750" }, { task: "Use 1 min(s) of Speedups on Construction", points: "+625" }, { task: "Increase Power by 1 through Construction", points: "+22" }, { task: "Use 1 min(s) of Speedups on Research", points: "+625" }, { task: "Increase Power by 1 through Research", points: "+10" }, { task: "Use 1 min(s) of Speedups on Troop Training/Upgrading", points: "+625" }, { task: "Train a Lv. 1 Soldier", points: "+14" }, { task: "Train a Lv. 2 Soldier", points: "+25" }, { task: "Train a Lv. 3 Soldier", points: "+39" }, { task: "Train a Lv. 4 Soldier", points: "+51" }, { task: "Train a Lv. 5 Soldier", points: "+61" }, { task: "Train a Lv. 6 Soldier", points: "N/A" }, { task: "Train a Lv. 7 Soldier", points: "N/A" }, { task: "Train a Lv. 8 Soldier", points: "N/A" }, { task: "Train a Lv. 9 Soldier", points: "N/A" }, { task: "Train a Lv. 10 Soldier", points: "N/A" },],
            "Day 6": [{ task: "Collect 1 Flawed Sandworm Egg in Burrow Conquest", points: "+5,000" }, { task: "Collect 1 Fresh Sandworm Egg in Burrow Conquest", points: "+50,000" }, { task: "Collect 1 Perfect Sandworm Egg in Burrow Conquest", points: "+500,000" }, { task: "Dispatch 1 A-class truck(s)", points: "+100,000" }, { task: "Perform 1 S-tier task(s) in Dire Dispatch", points: "+150,000" }, { task: "Use 1 min(s) of Speedups on Construction", points: "+625" }, { task: "Use 1 min(s) of Speedups on Research", points: "+625" }, { task: "Use 1 min(s) of Speedups on Troop Training/Upgrading", points: "+625" }, { task: "Use 1 minute(s) of Healing Speedups", points: "+625" }, { task: "Defeat 1 Lv. 1 troop in burrows, cities, or Arcadia", points: "+4" }, { task: "Defeat 1 Lv. 2 troop in burrows, cities, or Arcadia", points: "+9" }, { task: "Defeat 1 Lv. 3 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 4 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 5 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 6 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 7 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 8 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 9 troop in burrows, cities, or Arcadia", points: "N/A" }, { task: "Defeat 1 Lv. 10 troop in burrows, cities, or Arcadia", points: "N/A" },],
        };

        const turboTurtleTasks = {
            "Phase 1": [], "Phase 2": [],
            "Phase 3": [{ task: "Use 1 Behemoth Cell(s)", points: "+20,000" }, { task: "Every 100 Behemoth EXP gained in a single attempt", points: "+1,000" }, { task: "Use 1 min(s) of Speedups on Research", points: "+700" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+400" },],
            "Phase 4": [{ task: "Spend Draft Vouchers on Hero Recruitment 1 time(s)", points: "+20,000" }, { task: "Spend Advanced Recruitment Tokens on Hero Recruitment 1 time(s)", points: "+8,000" }, { task: "Spend Standard Recruitment Tokens on Hero Recruitment 1 time(s)", points: "+2,000" }, { task: "Use a Legendary Hero Fragment", points: "+35,000" }, { task: "Use an Epic Hero Fragment", points: "+9,000" }, { task: "Use a Rare Hero Fragment", points: "+3,000" }, { task: "Use 1 Hero Skill Manual(s)", points: "+2,500" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+400" },],
            "Phase 5": [{ task: "Use 1 Adhesive", points: "+3,000" }, { task: "Use 1 Chief Gear Design(s)", points: "+150,000" }, { task: "Use 100 points of Gear Scraps", points: "+4,000" }, { task: "Use 400 points of Gear Scraps", points: "+16,000" }, { task: "Use 2,000 points of Gear Scraps", points: "+80,000" }, { task: "Use 10,000 points of Gear Scraps", points: "+400,000" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+400" },],
            "Phase 6": [{ task: "Use 1 min(s) of Speedups on Research", points: "+700" }, { task: "Train or Upgrade Troops", points: "N/A" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+400" },],
            "Phase 7": [{ task: "Use 1 min(s) of Speedups on Construction", points: "+700" }, { task: "Use 1 min(s) of Speedups on Research", points: "+700" }, { task: "Recruitment items (see Phase 4 for details)", points: "N/A" }, { task: "Hero Fragments (see Phase 4 for details)", points: "N/A" }, { task: "Upgrading Hero Gear", points: "N/A" }, { task: "Use 1 Behemoth Cell(s)", points: "+20,000" }, { task: "Every 100 Behemoth EXP gained in a single attempt", points: "+1,000" }, { task: "Upgrading Chief Gear (see Phase 5 for details)", points: "N/A" }, { task: "Eliminate the Infected and Fiends", points: "N/A" }, { task: "Gather to gain points", points: "N/A" }, { task: "Earn 1 Diamonds through bundle purchases", points: "+400" },],
        };
        
        const powerPlaySchedule = {
            "Day 1": [
                { time: "01:00:00", theme: "Hero Upgrade" }, { time: "05:00:00", theme: "Settlement Construction" }, { time: "09:00:00", theme: "Chief Gear" },
                { time: "13:00:00", theme: "Tech Research" }, { time: "17:00:00", theme: "Gear Enhancement" }, { time: "21:00:00", theme: "Behemoth Growth" },
            ],
            "Day 2": [
                { time: "01:00:00", theme: "Settlement Construction" }, { time: "05:00:00", theme: "Chief Gear" }, { time: "09:00:00", theme: "Tech Research" },
                { time: "13:00:00", theme: "Gear Enhancement" }, { time: "17:00:00", theme: "Behemoth Growth" }, { time: "21:00:00", theme: "Hero Upgrade" },
            ],
            "Day 3": [
                { time: "01:00:00", theme: "Chief Gear" }, { time: "05:00:00", theme: "Tech Research" }, { time: "09:00:00", theme: "Gear Enhancement" },
                { time: "13:00:00", theme: "Behemoth Growth" }, { time: "17:00:00", theme: "Hero Upgrade" }, { time: "21:00:00", theme: "Settlement Construction" },
            ],
            "Day 4": [
                { time: "01:00:00", theme: "Tech Research" }, { time: "05:00:00", theme: "Gear Enhancement" }, { time: "09:00:00", theme: "Behemoth Growth" },
                { time: "13:00:00", theme: "Hero Upgrade" }, { time: "17:00:00", theme: "Settlement Construction" }, { time: "21:00:00", theme: "Chief Gear" },
            ],
            "Day 5": [
                { time: "01:00:00", theme: "Gear Enhancement" }, { time: "05:00:00", theme: "Behemoth Growth" }, { time: "09:00:00", theme: "Hero Upgrade" },
                { time: "13:00:00", theme: "Settlement Construction" }, { time: "17:00:00", theme: "Chief Gear" }, { time: "21:00:00", theme: "Tech Research" },
            ],
            "Day 6": [
                { time: "01:00:00", theme: "Behemoth Growth" }, { time: "05:00:00", theme: "Hero Upgrade" }, { time: "09:00:00", theme: "Settlement Construction" },
                { time: "13:00:00", theme: "Chief Gear" }, { time: "17:00:00", theme: "Tech Research" }, { time: "21:00:00", theme: "Gear Enhancement" },
            ],
            "Day 7": [
                { time: "01:00:00", theme: "Hero Upgrade" }, { time: "05:00:00", theme: "Settlement Construction" }, { time: "09:00:00", theme: "Chief Gear" },
                { time: "13:00:00", theme: "Tech Research" }, { time: "17:00:00", theme: "Gear Enhancement" }, { time: "21:00:00", theme: "Behemoth Growth" },
            ],
        };

        const versionHistory = [
            "v1.8 (2024-07-27): Renamed Home to Guide & Strategy and added detailed instructions.",
            "v1.7 (2024-07-27): Corrected Power Play schedule time to UTC+1.",
            "v1.6 (2024-07-27): Added Power Play event section with a full 7-day schedule.",
            "v1.5 (2024-07-27): Complete visual redesign to a dark theme based on in-game UI.",
            "v1.4 (2024-07-27): Complete visual redesign to match game theme. New colors, fonts, and layout.",
            "v1.3 (2024-07-27): Added detailed tasks and points for Turbo Turtle Phases 4, 5, 6, and 7.",
            "v1.2 (2024-07-27): Added detailed tasks and points for Turbo Turtle Phase 3.",
            "v1.1 (2024-07-27): Added Turbo Turtle event section with a 7-phase task overview.",
            "v1.0 (2024-07-27): Finalized initial data entry. Replaced placeholders with 'N/A'.",
            "v0.9 (2024-07-27): Added missing 'Defeat troop' tasks for Day 6 with 'N/A' points.",
            "v0.8 (2024-07-27): Added Day 6 Alliance Duel tasks.",
            "v0.7 (2024-07-27): Added missing 'Train a Soldier' tasks for Day 5 with 'N/A' points.",
            "v0.6 (2024-07-27): Added Day 5 Alliance Duel tasks.",
            "v0.5 (2024-07-25): Changed version history display to a pop-up modal.",
            "v0.4 (2024-07-25): Added Day 4 Alliance Duel tasks. Translated days to English. Added version history footer.",
            "v0.3 (2024-07-25): Added Alliance Duel section with weekly schedule and accordion for daily tasks. Populated Day 3.",
            "v0.2 (2024-07-25): Simplified Power Plant table to show only building prerequisites from level 17-30.",
            "v0.1 (2024-07-25): Initial app structure with navigation and placeholder sections.",
        ];

        // --- APP LOGIC ---
        document.addEventListener('DOMContentLoaded', function() {
            // Populate Power Plant Table
            const powerPlantTable = document.getElementById('power-plant-table');
            if (powerPlantTable) {
                powerPlantData.forEach(data => {
                    const row = powerPlantTable.insertRow();
                    row.className = 'hover:bg-slate-700/50';
                    let prereqHtml = '<span class="text-gray-400">N/A</span>';
                    if (data.prerequisites.length > 0) {
                        prereqHtml = '<ul class="list-disc list-inside">' + data.prerequisites.map(p => `<li>${p}</li>`).join('') + '</ul>';
                    }
                    row.innerHTML = `<td class="py-3 px-4 font-semibold">${data.level}</td><td class="py-3 px-4">${prereqHtml}</td>`;
                });
            }

            // Populate Alliance Duel Schedule
            const duelScheduleTable = document.getElementById('duel-schedule-table');
            if(duelScheduleTable) {
                allianceDuelSchedule.forEach(item => {
                    const row = duelScheduleTable.insertRow();
                     row.className = 'hover:bg-slate-700/50';
                    row.innerHTML = `<td class="py-3 px-4">${item.day}</td><td class="py-3 px-4 font-semibold">${item.theme}</td>`;
                });
            }

            // Function to create and populate an accordion
            function createAccordion(container, data, titlePrefix, dayMap) {
                 Object.keys(data).forEach((key, index) => {
                    const tasks = data[key];
                    const accordionItem = document.createElement('div');
                    accordionItem.className = 'bg-slate-800/70 backdrop-blur-sm rounded-xl shadow-lg';
                    
                    const dayName = dayMap ? `(${dayMap[index]})` : '';
                    const button = document.createElement('button');
                    button.className = 'w-full flex justify-between items-center p-4 text-left font-semibold text-lg text-emerald-400';
                    
                    const titleKey = isNaN(parseInt(key)) ? key : `${titlePrefix} ${index + 1}`;
                     button.innerHTML = `<span>${titleKey} ${dayName}</span><svg class="w-6 h-6 transform transition-transform text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>`;

                    const content = document.createElement('div');
                    content.className = 'accordion-content px-4 pb-4';

                    if (tasks.length > 0 && typeof tasks[0] === 'object') {
                        let taskTable = '<table class="min-w-full text-left"><thead><tr class="border-b-2 border-slate-600"><th class="py-2 font-semibold">Task</th><th class="py-2 font-semibold">Points</th></tr></thead><tbody class="divide-y divide-slate-700">';
                        tasks.forEach(task => {
                            taskTable += `<tr class="hover:bg-slate-700/50"><td class="py-2 pr-4">${task.task}</td><td class="py-2 font-medium text-emerald-400">${task.points}</td></tr>`;
                        });
                        taskTable += '</tbody></table>';
                        content.innerHTML = taskTable;
                    } 
                    else if (tasks.length > 0) {
                        content.innerHTML = '<ul class="list-disc list-inside text-gray-300">' + tasks.map(t => `<li>${t}</li>`).join('') + '</ul>';
                    }
                    else {
                        content.innerHTML = '<p class="text-gray-400">N/A</p>';
                    }
                    
                    accordionItem.appendChild(button);
                    accordionItem.appendChild(content);
                    container.appendChild(accordionItem);

                    button.addEventListener('click', () => {
                        const svg = button.querySelector('svg');
                        if (content.style.maxHeight) {
                            content.style.maxHeight = null;
                            svg.style.transform = 'rotate(0deg)';
                        } else {
                            content.style.maxHeight = content.scrollHeight + "px";
                            svg.style.transform = 'rotate(180deg)';
                        }
                    });
                });
            }
            
            // Populate Alliance Duel Daily Tasks Accordion
            const duelDailyTasksContainer = document.getElementById('duel-daily-tasks');
            if (duelDailyTasksContainer) {
                 const duelDataForAccordion = allianceDuelSchedule.map(item => {
                    return { title: `${item.day}: ${item.theme}`, tasks: allianceDuelTasks[item.day.split(' ')[0] + " " + item.day.split(' ')[1]] || [] };
                });
                
                duelDataForAccordion.forEach(item => {
                    const accordionItem = document.createElement('div');
                    accordionItem.className = 'bg-slate-800/70 backdrop-blur-sm rounded-xl shadow-lg';
                    const button = document.createElement('button');
                    button.className = 'w-full flex justify-between items-center p-4 text-left font-semibold text-lg text-emerald-400';
                    button.innerHTML = `<span>${item.title}</span><svg class="w-6 h-6 transform transition-transform text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>`;
                    const content = document.createElement('div');
                    content.className = 'accordion-content px-4 pb-4';
                    if (item.tasks.length > 0) {
                        let taskTable = '<table class="min-w-full text-left"><thead><tr class="border-b-2 border-slate-600"><th class="py-2 font-semibold">Task</th><th class="py-2 font-semibold">Points</th></tr></thead><tbody class="divide-y divide-slate-700">';
                        item.tasks.forEach(task => {
                            taskTable += `<tr class="hover:bg-slate-700/50"><td class="py-2 pr-4">${task.task}</td><td class="py-2 font-medium text-emerald-400">${task.points}</td></tr>`;
                        });
                        taskTable += '</tbody></table>';
                        content.innerHTML = taskTable;
                    } else {
                        content.innerHTML = '<p class="text-gray-400">N/A</p>';
                    }
                    accordionItem.appendChild(button);
                    accordionItem.appendChild(content);
                    duelDailyTasksContainer.appendChild(accordionItem);
                    button.addEventListener('click', () => {
                        const svg = button.querySelector('svg');
                        if (content.style.maxHeight) {
                            content.style.maxHeight = null;
                            svg.style.transform = 'rotate(0deg)';
                        } else {
                            content.style.maxHeight = content.scrollHeight + "px";
                            svg.style.transform = 'rotate(180deg)';
                        }
                    });
                });
            }

            // Populate Turbo Turtle Tasks
            const turtleDailyTasksContainer = document.getElementById('turtle-daily-tasks');
            if (turtleDailyTasksContainer) {
                const dayMap = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
                createAccordion(turtleDailyTasksContainer, turboTurtleTasks, "Phase", dayMap);
            }
            
            // Populate Power Play Schedule
            const powerPlayContainer = document.getElementById('power-play-daily-tasks');
            if (powerPlayContainer) {
                const dayMap = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
                Object.keys(powerPlaySchedule).forEach((key, index) => {
                    const schedule = powerPlaySchedule[key];
                    const accordionItem = document.createElement('div');
                    accordionItem.className = 'bg-slate-800/70 backdrop-blur-sm rounded-xl shadow-lg';
                    
                    const button = document.createElement('button');
                    button.className = 'w-full flex justify-between items-center p-4 text-left font-semibold text-lg text-emerald-400';
                    button.innerHTML = `<span>${key} (${dayMap[index]})</span><svg class="w-6 h-6 transform transition-transform text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>`;

                    const content = document.createElement('div');
                    content.className = 'accordion-content px-4 pb-4';

                    let scheduleTable = '<table class="min-w-full text-left"><thead><tr class="border-b-2 border-slate-600"><th class="py-2 font-semibold">Opening Time (UTC+1)</th><th class="py-2 font-semibold">Theme</th></tr></thead><tbody class="divide-y divide-slate-700">';
                    schedule.forEach(item => {
                        scheduleTable += `<tr class="hover:bg-slate-700/50"><td class="py-2 pr-4">${item.time}</td><td class="py-2">${item.theme}</td></tr>`;
                    });
                    scheduleTable += '</tbody></table>';
                    content.innerHTML = scheduleTable;
                    
                    accordionItem.appendChild(button);
                    accordionItem.appendChild(content);
                    powerPlayContainer.appendChild(accordionItem);

                    button.addEventListener('click', () => {
                        const svg = button.querySelector('svg');
                        if (content.style.maxHeight) {
                            content.style.maxHeight = null;
                            svg.style.transform = 'rotate(0deg)';
                        } else {
                            content.style.maxHeight = content.scrollHeight + "px";
                            svg.style.transform = 'rotate(180deg)';
                        }
                    });
                });
            }

            // Populate Version History
            const versionList = document.getElementById('version-list');
            if (versionList) {
                versionHistory.forEach(version => {
                    const li = document.createElement('li');
                    li.textContent = version;
                    versionList.appendChild(li);
                });
            }

            // --- EVENT LISTENERS ---
            // Navigation Logic
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            const defaultHash = '#guide';
            function changeSection(hash) {
                const targetHash = hash || defaultHash;
                navLinks.forEach(link => link.classList.toggle('active', link.getAttribute('href') === targetHash));
                contentSections.forEach(section => section.classList.toggle('active', '#' + section.id === targetHash));
            }
            const navMenu = document.getElementById('nav-menu');
            navMenu.addEventListener('click', function(e) {
                const link = e.target.closest('a.nav-link');
                if (link) {
                    e.preventDefault();
                    const targetHash = link.getAttribute('href');
                    if (window.location.hash !== targetHash) history.pushState(null, null, targetHash);
                    changeSection(targetHash);
                }
            });
            window.addEventListener('popstate', () => changeSection(window.location.hash));
            changeSection(window.location.hash || defaultHash);

            // Modal Logic
            const versionBtn = document.getElementById('version-history-btn');
            const modal = document.getElementById('version-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const closeModal = () => modal.classList.remove('flex');
            versionBtn.addEventListener('click', () => modal.classList.add('flex'));
            closeModalBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });
        });
    </script>

</body>
</html>
